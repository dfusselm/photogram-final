<div>
  <div>
    <h1>
      List of users
    </h1>
  </div>
</div>


<div>
  <div>
    <table border="1">
      <tr>
        <th>
          Username
        </th>

        <th>
          Private?
        </th>

        <th>
          
        </th>

        <th>
          
        </th>

      </tr>

      <% @list_of_users.each do |a_user| %>
      <tr>
        <td>
          <%= a_user.username %>
        </td>

        <td>
          <% if a_user.private != true %>
          No
          <% else %>
          Yes
          <% end %>
        </td>

        <td>
        <%# current_accepted_request = FollowRequest.where({:recipient_id => a_user.id, :sender_id => current_user.id, :status => "accepted"}) %>
            <%# current_pending_request = FollowRequest.where({:recipient_id => a_user.id, :sender_id => current_user.id, :status => "pending"}) %>
            <%# current_rejected_request = FollowRequest.where({:recipient_id => a_user.id, :sender_id => current_user.id, :status => "rejected"}) %>

            <%# the_accepted_request = current_accepted_request.first %>
            <%# the_pending_request = current_pending_request.first %>
            <%# the_rejected_request = current_rejected_request.first %>
          <% if current_user != nil %>
            
           <%# @current_accepted_requests.each do |a_request| %>
            <%# if a_request.recipient_id == a_user.id %>
              
            <%# end %> 
            <%# end %>

            
            <% current_accepted_request = FollowRequest.where({:recipient_id => a_user.id, :sender_id => current_user.id, :status => "accepted"}) %>
            <% current_pending_request = FollowRequest.where({:recipient_id => a_user.id, :sender_id => current_user.id, :status => "pending"}) %>
            <% current_rejected_request = FollowRequest.where({:recipient_id => a_user.id, :sender_id => current_user.id, :status => "rejected"}) %>

            <% the_accepted_request = current_accepted_request.first %>
            <% the_pending_request = current_pending_request.first %>
            <% the_rejected_request = current_rejected_request.first %>

          <% if the_accepted_request != nil %>
              <a href="/delete_follow_request/<%= the_accepted_request.id %>">Unfollow</a>

              <% elsif the_pending_request != nil %>
                Request sent. <a href="/delete_follow_request/<%= the_pending_request.id %>">Cancel</a>
              
              <% elsif the_rejected_request != nil %>
              <% else %>
              <form action="/insert_follow_request" method="post">
              <button>
               Follow
              </button>
              </form>
            
            
            <% end %>    

            
          <% end %>
        </td>

        <td>
          <a href="/users/<%= a_user.username %>">
            Show details
          </a>
        </td>
      </tr>
      <% end %>
    </table>
  </div>
</div>
